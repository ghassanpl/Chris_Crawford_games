UNIT Init;INTERFACEUSES{$L-}{$U-}     {$LOAD MQOTP.dumpfile}       Memtypes, QuickDraw, OSIntf, ToolIntf, PackIntf,	 {$LOAD Globals.dumpfile}     {$U Globals.p}  Globals;	 {$LOAD}{$U+}{$SETC DebugFlg:=FALSE}PROCEDURE InitGame;IMPLEMENTATION{$S Initialize}{********************************************************************************}PROCEDURE InitAff(Who,Aff1,Aff2,Aff3,Aff4,Aff5,Aff6,Aff7:   Integer);VAR  i,j: Integer;BEGIN  Love[Who,1]:=Aff1;  Love[Who,2]:=Aff2;  Love[Who,3]:=Aff3;  Love[Who,4]:=Aff4;  Love[Who,5]:=Aff5;  Love[Who,6]:=Aff6;  Love[Who,7]:=Aff7;END;{********************************************************************************}PROCEDURE InitTrust(Who,Trust1,Trust2,Trust3,Trust4,Trust5,Trust6,Trust7: Integer);BEGIN  Trust[Who,1]:=Trust1;  Trust[Who,2]:=Trust2;  Trust[Who,3]:=Trust3;  Trust[Who,4]:=Trust4;  Trust[Who,5]:=Trust5;  Trust[Who,6]:=Trust6;  Trust[Who,7]:=Trust7;END;{********************************************************************************}PROCEDURE InitFear(Who,Fear1,Fear2,Fear3,Fear4,Fear5,Fear6,Fear7: Integer);BEGIN  Fear[Who,1]:=Fear1;  Fear[Who,2]:=Fear2;  Fear[Who,3]:=Fear3;  Fear[Who,4]:=Fear4;  Fear[Who,5]:=Fear5;  Fear[Who,6]:=Fear6;  Fear[Who,7]:=Fear7;END;{********************************************************************************}PROCEDURE InitGame;VAR  i,j,k,x,y:   Integer;  TempRect:    Rect;  SRefCon:     LongInt;  DumbFlag:    Boolean;  Amp,Delta,z:	 Integer;  Amp2,Delta2,z2:   Integer;  Count:		LongInt;  RefNum:		Integer;  error:		OSErr;BEGIN  PenPat(white);  PaintRect(thePort^.portRect);  TextMode(SrcOr);  InitCursor;  RandSeed:=TickCount;  y:=5;  {$IFC DebugFlg} y:=y+1; {$ENDC}  FOR i:=1 TO y DO MenuArr[i]:=GetMenu(i);  FOR i:=1 TO y DO InsertMenu(MenuArr[i],0);  DrawMenuBar;  IF SoundOn THEN SetItem(MenuArr[3],1,'Turn Sound Off')			 ELSE SetItem(MenuArr[3],1,'Turn Sound On');  IF NarratOn THEN SetItem(MenuArr[3],2,'Turn Narration Off')			  ELSE SetItem(MenuArr[3],2,'Turn Narration On');  IF StoryDelay=ExpDelay THEN CheckItem(MenuArr[3],5,TRUE);  IF StoryDelay=BegDelay THEN CheckItem(MenuArr[3],3,TRUE);  PenNormal;  SetRect(WordRect,0,ScrnY1,ScrnX1-3,342);  SetRect(RoomRect,ScrnX2,ScrnY2,512,342);  SetRect(PlayRect,ScrnX2,ScrnY1,512,ScrnY2-3);  SetRect(ComdRect,ScrnX1,ScrnY1,ScrnX1+62,ScrnY2-3);  SetRect(StatRect,ScrnX1+62,ScrnY1,ScrnX2-3,ScrnY2-3);  SetRect(FeelRect,ScrnX1,ScrnY2,ScrnX2-3,342);  SetRect(FaceRect,ScrnX1+22,246,ScrnX1+118,342);  DiurnalP:=white;  QuitFlag:=FALSE;  CurWord:=0;  {$IFC DebugFlg}  DealCount:=0;  {$ENDC}  FOR i:=1 TO SntcLeng DO    BEGIN      FOR j:=1 TO NumChars DO BEGIN Sentence[j,i]:=0; LastSntc[j,i]:=0; END;      CanclAble[i]:=FALSE;    END;  SntcIndx:=0;  MoveTo(ScrnX1-3,ScrnY1); LineTo(ScrnX1-3,342);  MoveTo(ScrnX1-1,ScrnY1); LineTo(ScrnX1-1,342);  MoveTo(ScrnX1,ScrnY2-3); LineTo(512,ScrnY2-3);  MoveTo(ScrnX1,ScrnY2-1); LineTo(512,ScrnY2-1);  MoveTo(ScrnX2-3,ScrnY1); LineTo(ScrnX2-3,342);  MoveTo(ScrnX2-1,ScrnY1); LineTo(ScrnX2-1,342);  PenPat(Gray);  MoveTo(ScrnX1-2,ScrnY1); LineTo(ScrnX1-2,342);  MoveTo(ScrnX1,ScrnY2-2); LineTo(512,ScrnY2-2);  MoveTo(ScrnX2-2,ScrnY1); LineTo(ScrnX2-2,342);  PenNormal;  WordPosX[1]:=0; WordPosY[1]:=0;  WordPosX[2]:=40; WordPosY[2]:=0;  WordPosX[3]:=80; WordPosY[3]:=0;  WordPosX[4]:=40; WordPosY[4]:=40;  WordPosX[5]:=80; WordPosY[5]:=40;  WordPosX[6]:=120; WordPosY[6]:=40;  WordPosX[7]:=160; WordPosY[7]:=40;  WordPosX[8]:=120; WordPosY[8]:=80;  DealPosX[1]:=0; DealPosY[1]:=0;  DealPosX[2]:=40; DealPosY[2]:=0;  DealPosX[3]:=80; DealPosY[3]:=0;  DealPosX[4]:=40; DealPosY[4]:=40;  DealPosX[5]:=40; DealPosY[5]:=80;  DealPosX[6]:=120; DealPosY[6]:=0;  DealPosX[7]:=160; DealPosY[7]:=0;  DealPosX[8]:=200; DealPosY[8]:=0;  DealPosX[9]:=240; DealPosY[9]:=0;  DealPosX[10]:=200; DealPosY[10]:=40;  DealPosX[11]:=200; DealPosY[11]:=80;    FOR i:=1 TO 99 DO StoryParm[i]:=-1;  StoryParm[1]:=8;  StoryParm[2]:=31;  StoryParm[3]:=40;  StoryParm[4]:=8;  StoryParm[5]:=8;  StoryParm[6]:=14;  StoryParm[7]:=15;  StoryParm[8]:=46;  StoryParm[9]:=8;  StoryParm[10]:=13;  StoryParm[11]:=16;  StoryParm[12]:=51;  StoryParm[13]:=44;  StoryParm[14]:=18;  StoryParm[15]:=8;  StoryParm[16]:=24;  StoryParm[17]:=24;  StoryParm[18]:=24;  StoryParm[19]:=8;  StoryParm[20]:=-8;  StoryParm[21]:=-1032;  StoryParm[22]:=-1032;  StoryParm[23]:=-24;  StoryParm[24]:=40;  StoryParm[25]:=8;  StoryParm[26]:=26;  StoryParm[27]:=-27;  StoryParm[28]:=-28;  StoryParm[29]:=-30;  StoryParm[30]:=8;  StoryParm[31]:=-748;  StoryParm[32]:=-683;  StoryParm[33]:=-110;  StoryParm[34]:=-237;  StoryParm[35]:=-169;  StoryParm[36]:=-106;  StoryParm[37]:=1024;  StoryParm[38]:=1024;  StoryParm[39]:=1024;  StoryParm[40]:=1024;  StoryParm[41]:=1024;  StoryParm[42]:=48;  StoryParm[43]:=111;  StoryParm[44]:=-8;    Aslyn:=0;  FBetrayals:=0;  PlayerDeals:=0;  DlogCount:=0;  InitAff(1,127,0,-50,40,-10,-80,60);  InitAff(2,0,127,-20,-20,-10,-20,70);  InitAff(3,-10,30,127,-70,-30,30,50);  InitAff(4,20,-40,-40,127,40,40,-20);  InitAff(5,-30,-20,10,30,127,70,-60);  InitAff(6,-40,-30,60,50,60,127,-90);  InitAff(7,60,60,40,-30,-50,-80,127);  InitTrust(1,127,40,-30,0,-60,10,40);  InitTrust(2,-20,127,80,70,40,-90,-80);  InitTrust(3,-40,-50,127,-20,60,30,20);  InitTrust(4,50,60,40,127,-50,-50,-50);  InitTrust(5,20,-20,-50,0,127,0,50);  InitTrust(6,-30,10,-50,-30,30,127,20);  InitTrust(7,0,20,10,-20,-20,40,127);  InitFear(1,127,80,-20,30,-50,-20,-20);  InitFear(2,-40,127,20,30,20,-20,-10);  InitFear(3,-40,-20,127,-10,60,30,-20);  InitFear(4,20,-40,40,127,-40,40,-20);  InitFear(5,30,-60,-30,-50,127,40,60);  InitFear(6,50,30,30,40,40,127,-40);  InitFear(7,-20,10,-40,-40,-30,0,127);    DoorLock[Player]:=FALSE;  Time:=Dawn; Day:=1;  FOR i:=1 TO NumChars DO    BEGIN	  FOR j:=1 TO 3 DO AuraCnt[j,i,0]:=8;	  FOR k:=1 TO 2*GameLeng DO	    BEGIN		  REPEAT j:=Abs(Random div 8192) UNTIL (j>0) & (j<=3);		  AuraCnt[j,i,0]:=AuraCnt[j,i,0]-1;		END;      FOR j:=1 TO 3 DO AuraCnt[j,i,i]:=AuraCnt[j,i,0];	  FOR j:=1 TO NumChars DO	    BEGIN		  FOR k:=1 TO 64 DO NBetray[i,j,k]:=FALSE;		  NAttack[i,j]:=FALSE;		  NBetrayCount[i,j]:=0;		  NAttackCount[i,j]:=0;		  Beneficence[i,j]:=0;		  Visits[i,j]:=0;		END;	END;  FOR i:=1 TO NumChars DO    BEGIN      FOR j:=1 TO NumChars DO IF j<>i THEN	    BEGIN	      FOR k:=1 TO 3 DO AuraCnt[k,j,i]:=-1;	      REPEAT k:=Abs(Random div 8192) UNTIL (k>0) AND (k<=3);	      AuraCnt[k,j,i]:=AuraCnt[k,j,0];	    END;	END;  FOR i:=1 TO NumChars DO IF i<>Player THEN    BEGIN {put in handicap for player}	  x:=Love[i,Player];	  x:=x+16*(3-Level);	  IF x>127 THEN x:=127;	  Love[i,Player]:=x;	  	  x:=Trust[i,Player];	  x:=x+16*(3-Level);	  IF x>127 THEN x:=127;	  Trust[i,Player]:=x;	  	  x:=Fear[Player,i];	  x:=x+16*(3-Level);	  IF x>127 THEN x:=127;	  Fear[Player,i]:=x;	  	  Loyalty[i]:=Loyalty[i]*(4-Level);	  Integrity[i]:=Integrity[i]*(4-Level);	  Temper[i]:=Temper[i]*(4-Level);	  Revenge[i]:=Revenge[i]*(4-Level);	  Duty[i]:=Duty[i]*(4-Level);	  Pride[i]:=Pride[i]*(4-Level);	  Secret[i]:=Secret[i]*(4-Level);	  DesLiked[i]:=DesLiked[i]*(4-Level);	  Gullble[i]:=Gullble[i]*(4-Level);	  	END;  MaxPers:=16*(4-Level);  HstDateH:=DatesHndl(NewHandle(2*HistLeng));  HstTimeH:=DatesHndl(NewHandle(2*HistLeng));  HstWrd1H:=DatesHndl(NewHandle(2*HistLeng));  HstWrd3H:=DatesHndl(NewHandle(2*HistLeng));    HistIndx:=0;  FOR i:=1 TO HistLeng DO    BEGIN      HstWrd1H^^[i]:=0;      HstWrd3H^^[i]:=0;      FOR j:=1 TO NumChars DO HstKnowH[i,j]:=FALSE;      HstDateH^^[i]:=0;      HstTimeH^^[i]:=0;    END;  SetRect(BkSpRect,ScrnX1+4,ScrnY1+4,ScrnX1+60,ScrnY1+34);  SetRect(DoItRect,ScrnX1+4,ScrnY1+42,ScrnX1+60,ScrnY1+72);  SetRect(CnclRect,ScrnX1+4,ScrnY1+80,ScrnX1+60,ScrnY1+110);  SetRect(OKRect,ScrnX1+4,ScrnY1+118,ScrnX1+60,ScrnY1+148);  TransIndx:=0;  BarGraphLabl[1]:='Previous fear of Vetvel';  BarGraphLabl[2]:='Current fear of Vetvel';  BarGraphLabl[3]:='Previous trust in Vetvel';  BarGraphLabl[4]:='Current trust in Vetvel';  BarGraphLabl[5]:='Previous love for Vetvel';  BarGraphLabl[6]:='Current love for Vetvel';  Narrate(1,Player);  Narrate(2,Player);END;{********************************************************************************}END.